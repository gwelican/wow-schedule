(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{505:function(t,e,o){var content=o(523);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(24).default)("16c88736",content,!0,{sourceMap:!1})},522:function(t,e,o){"use strict";o(505)},523:function(t,e,o){var n=o(23)((function(i){return i[1]}));n.push([t.i,".timeslot{\n  --tw-bg-opacity:1;\n  background-color:rgba(191, 219, 254, var(--tw-bg-opacity));\n  --tw-border-opacity:1;\n  border-color:rgba(0, 0, 0, var(--tw-border-opacity));\n  border-style:solid;\n  border-right-width:2px;\n  border-left-width:2px;\n  height:0.375rem;\n  width:2.5rem;\n  gap:0px\n}\n.timeslot:nth-child(2n+0){\n  --tw-border-opacity:1;\n  border-color:rgba(0, 0, 0, var(--tw-border-opacity));\n  border-style:solid;\n  border-top-width:2px\n}\n.timeslot:nth-child(4n+0){\n  border-top-style:dotted;\n  --tw-border-opacity:1;\n  border-color:rgba(0, 0, 0, var(--tw-border-opacity));\n  border-top-width:2px\n}\n.timeslot-time{\n  margin-top:-0.75rem;\n  padding-right:0.25rem;\n  text-align:right;\n  --tw-text-opacity:1;\n  color:rgba(0, 0, 0, var(--tw-text-opacity));\n  grid-row:span 3 / span 3;\n  grid-row-start:2\n}\n.selected{\n  --tw-bg-opacity:1;\n  background-color:rgba(4, 120, 87, var(--tw-bg-opacity))\n}\n.bullshit{\n  grid-column-start:3;\n  grid-column-start:4;\n  grid-column-start:5;\n  grid-column-start:6;\n  grid-column-start:7;\n  grid-column-start:8;\n  grid-column-start:9;\n  grid-column-start:10;\n  grid-column-start:11\n}",""]),t.exports=n},558:function(t,e,o){"use strict";o.r(e);o(78);var n=o(29),r=o(27),l=o(41),c=o(42),m=o(39),d=o(21),f=o(18),v=(o(15),o(309),o(25),o(50),o(310),o(311),o(312),o(313),o(314),o(315),o(316),o(317),o(318),o(319),o(320),o(321),o(322),o(54),o(87),o(59),o(36),o(183),o(112),o(184),o(49),o(90),o(13),o(12),o(14),o(57),o(83),o(516),o(37),o(40),o(151)),h=o(75),y=o(519),w=o.n(y),k=o(562);function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=Object(d.a)(t);if(e){var r=Object(d.a)(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return Object(m.a)(this,o)}}var z,S,x,T=function(t,e,o,desc){var n,r=arguments.length,l=r<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,o):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(f.a)(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,o,desc);else for(var i=t.length-1;i>=0;i--)(n=t[i])&&(l=(r<3?n(l):r>3?n(e,o,l):n(e,o))||l);return r>3&&l&&Object.defineProperty(e,o,l),l};!function(t){t[t.DELETE=0]="DELETE",t[t.ADD=1]="ADD"}(S||(S={})),function(t){t[t.DOWN=0]="DOWN",t[t.UP=1]="UP"}(x||(x={}));var D=Object(v.namespace)("myschedule"),O=z=function(t){Object(c.a)(o,t);var e=_(o);function o(){var t;return Object(r.a)(this,o),(t=e.apply(this,arguments)).forceRenderNumber=100,t.timezoneModel="",t.timezones=[],t.availability=new Map,t.days=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],t.mouseButtonState=x.UP,t.operation=S.ADD,t}return Object(l.a)(o,[{key:"updateTimezone",value:function(t){this.setTimezone(t)}},{key:"save",value:function(){var t=this;h.DateTime.fromISO("2017-05-15T09:10:23",{zone:"Europe/Paris"});var e=Array.from(this.availability).map((function(e){var o=Object(n.a)(e,2),r=o[0];return o[1].map((function(e){return{start:Number(e.start.toFormat("HHmm")),end:Number(e.end.toFormat("HHmm")),timezone:t.timezone,day:r}}))}));this.saveSchedule({apollo:this.$apollo,timezone:this.timezone,schedule:e.flat()}).then((function(){t.$toast.success("Saved").goAway(2e3)}))}},{key:"checkValidTimezone",value:function(){var t=this;return void 0!==this.timezones.find((function(e){return e.abbreviation===t.timezone}))}},{key:"daySortFunction",get:function(){var t=this;return function(a,b){var e=t.days.findIndex((function(t){return t===a})),o=t.days.findIndex((function(t){return t===b}));return e===o?0:e<o?-1:1}}},{key:"hours",get:function(){for(var t=[],i=0;i<24;i++)t.push(i);return t}},{key:"mouseUp",value:function(){this.mouseButtonState=x.UP,this.createAvailabilityRangesFromTimeslots(),this.forceRenderNumber++}},{key:"createAvailabilityRangesFromTimeslots",value:function(){if(this.timeslot.size>0){var t=w.a.groupBy(Array.from(this.timeslot),(function(t){return t.split("_")[0]})),e=Object.keys(t);this.cleanupInactiveDays(e);for(var o=0,n=e;o<n.length;o++){var r=n[o],l=t[r].map((function(t){var slot=parseInt(t.split("_")[1]),e=2345===slot?14:15;return h.Interval.fromDateTimes(h.DateTime.fromObject({hour:Math.floor(slot/100),minute:slot%100}),h.DateTime.fromObject({hour:Math.floor(slot/100),minute:slot%100}).plus(h.Duration.fromObject({minutes:e})))})),c=h.Interval.merge(l);this.availability.set(r,c)}}else this.availability.clear();console.log(this.timeslot),console.log(this.availability),this.forceRenderNumber++}},{key:"cleanupInactiveDays",value:function(t){var e=this;console.log("active days "+t),Array.from(this.availability.keys()).filter((function(e){return!t.includes(e)})).forEach((function(t){e.availability.delete(t)}))}},{key:"mouseOver",value:function(t,slot){var e=z.createKey(t,slot);this.mouseButtonState===x.DOWN&&this.$refs[e]&&(this.operation===S.ADD?this.selectTimeslot(t,slot):this.operation===S.DELETE&&this.deSelectTimeslot(t,slot))}},{key:"selectTimeslot",value:function(t,slot){var e=z.createKey(t,slot);if(this.$refs[e]){var o=this.$refs[e];o.length>0&&o[0].classList.add("selected")}this.addTimeslotKey(e)}},{key:"deSelectTimeslot",value:function(t,slot){var e=z.createKey(t,slot);if(this.$refs[e]){var o=this.$refs[e];o.length>0&&o[0].classList.remove("selected")}this.deleteTimeslotKey(e)}},{key:"mouseDown",value:function(t,slot){this.operation=this.timeslot.has(z.createKey(t,slot))?S.DELETE:S.ADD,this.mouseButtonState=x.DOWN,this.mouseOver(t,slot)}},{key:"createSlot",value:function(t,e){return String(t).padStart(2,"0")+String(e).padStart(2,"0")}},{key:"getTimeslotClasses",value:function(t,slot){var e=["timeslot"];return this.timeslot.has(z.createKey(t,slot))&&e.push("selected"),e}},{key:"mounted",value:function(){var t=this;this.timezones=Object(k.a)(),this.loadSchedule(this.$apollo).then((function(){t.createAvailabilityRangesFromTimeslots(),t.initializeTimezone()}))}},{key:"initializeTimezone",value:function(){if(this.timezoneModel=this.timezone,console.log(this.timezone),0===this.timeslot.size&&""===this.timezone){var t=this.timezones.find((function(t){return t.name===h.Settings.defaultZoneName}));t?this.setTimezone(t.abbreviation):this.$toast.error("Cannot detect timezone")}}}],[{key:"createKey",value:function(t,slot){return"".concat(t,"_").concat(slot)}}]),o}(v.Vue);T([D.Mutation],O.prototype,"setTimezone",void 0),T([D.Mutation],O.prototype,"deleteTimeslotKey",void 0),T([D.Mutation],O.prototype,"addTimeslotKey",void 0),T([D.State],O.prototype,"timeslot",void 0),T([D.State],O.prototype,"timezone",void 0),T([D.Action],O.prototype,"loadSchedule",void 0),T([D.Action],O.prototype,"saveSchedule",void 0),T([Object(v.Watch)("timezoneModel")],O.prototype,"updateTimezone",null);var j=O=z=T([Object(v.Component)({filters:{humanDate:function(t){return t.start.toFormat("HH:mm")+"-"+t.end.toFormat("HH:mm")}},middleware:"auth.middleware"})],O),C=(o(522),o(111)),A=o(149),M=o.n(A),R=o(556),E=o(224),F=o(503),component=Object(C.a)(j,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-container",[o("div",{staticClass:"tw-rounded tw-bg-gray-700 tw-mx-auto tw-flex xs:tw-w-1/2 lg:tw-w-3/4"},[o("div",{staticClass:"lg:tw-w-1/2 xs:tw-w-1/3 tw-m-1 tw-flex-col tw-flex tw-items-center"},[o("v-autocomplete",{staticClass:"tw-w-2/3",staticStyle:{"flex-grow":"0","flex-direction":"column-reverse"},attrs:{"background-color":"#035b45",items:t.timezones,"item-value":"abbreviation","item-text":"abbreviation",rules:[t.checkValidTimezone]},on:{mousedown:function(e){t.timezoneModel=""}},scopedSlots:t._u([{key:"item",fn:function(e){var n=e.item;return[o("div",[t._v(t._s(n.abbreviation)+" ("+t._s(n.rawFormat)+")")])]}},{key:"selection",fn:function(e){var n=e.item;return[o("div",[t._v(t._s(n.abbreviation)+" ("+t._s(n.rawFormat)+")")])]}}]),model:{value:t.timezoneModel,callback:function(e){t.timezoneModel=e},expression:"timezoneModel"}}),t._v(" "),t._l(Array.from(t.availability.keys()).sort(t.daySortFunction),(function(e){return o("div",{key:e,staticClass:"tw-rounded tw-bg-gray-500 tw-mt-2 tw-p-2 hover:tw-bg-blue-800 tw-w-full"},[t._v("\n        "+t._s(e)+":\n        "),t._l(t.availability.get(e),(function(e){return o("span",{key:e.start.toISO(),staticClass:"tw-h-auto"},[t._v("\n          ["+t._s(t._f("humanDate")(e))+"]\n        ")])}))],2)})),t._v(" "),o("v-btn",{staticClass:"tw-w-1/2 tw-mt-2",on:{click:t.save}},[t._v("Save")])],2),t._v(" "),o("div",{key:t.forceRenderNumber,staticClass:"tw-bg-white tw-p-6 lg:tw-w-1/2 xs:tw-w-2/3 tw-rounded tw-px-2 tw-py-1 tw-m-1"},[o("div",{staticClass:"tw-grid tw-grid-flow-col tw-grid-cols-7 tw-w-auto tw-m-auto tw-text-black tw-col-start-2"},t._l(t.days,(function(e,n){return o("div",{key:n,staticClass:"tw-pl-1 tw-w-10",class:"tw-col-start-"+(n+2)},[o("span",{staticClass:"xs:tw-text-xs"},[t._v("\n            "+t._s(e)+"\n          ")])])})),0),t._v(" "),t._l(t.hours,(function(e){return o("div",{key:e,staticClass:"tw-grid tw-grid-flow-col tw-grid-cols-7 tw-w-auto tw-m-auto",on:{mouseup:function(e){return e.stopPropagation(),t.mouseUp(e)}}},[o("div",{staticClass:"timeslot-time tw-w-full xs:tw-text-2xs"},[t._v(t._s(e)+":00")]),t._v(" "),t._l(t.days,(function(n){return t._l([0,15,30,45],(function(r){return o("div",{key:n+"_"+t.createSlot(e,r),ref:n+"_"+t.createSlot(e,r),refInFor:!0,class:t.getTimeslotClasses(n,t.createSlot(e,r)),attrs:{"data-time":n+"_"+t.createSlot(e,r)},on:{mouseover:function(o){t.mouseOver(n,t.createSlot(e,r))},mousedown:function(o){t.mouseDown(n,t.createSlot(e,r))},mouseup:function(e){return e.stopPropagation(),t.mouseUp(e)},touchstart:function(o){o.stopPropagation(),t.mouseDown(n,t.createSlot(e,r))},touchend:function(e){return e.stopPropagation(),t.mouseUp(e)},touchmove:function(o){o.stopPropagation(),t.mouseOver(n,t.createSlot(e,r))}}})}))}))],2)}))],2)])])}),[],!1,null,null,null);e.default=component.exports;M()(component,{VAutocomplete:R.a,VBtn:E.a,VContainer:F.a})}}]);